$INCLUDE "RefTorch";

$ENTRY Go {
  = <Main>;
}

Main {
  = <Prout 'Testing SwiGLU...'>
    <DoTest>;
}

DoTest {
  = /* Gate input: 10.0 */
    <TFromList (1) (10000)> : s.Gate
    
    /* Value input: 2.0 */
    <TFromList (1) (2000)> : s.Val
    
    /* Compute */
    <TSwiGLU s.Gate s.Val> : s.Out
    
    <Prout 'Gate: 10.0, Value: 2.0'>
    <Prout 'Result (Expect ~20.0):'>
    <TPrint s.Out>
    
    <TFreeAll>;
}
